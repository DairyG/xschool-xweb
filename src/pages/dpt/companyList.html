<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="../../layui/css/layui.css" />
    <link rel="stylesheet" href="../../layui/css/common.css" />
    <script type="text/javascript" src="../../lib/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="../../layui/layui.js"></script>
    <script type="text/javascript" src="../../js/service.js"></script>
    <script type="text/javascript" src="../../js/common.js"></script>
    <script type="text/javascript" src="../../js/pager.js"></script>
</head>
<body class="bgf2f2f2">
    <div class="childrenBody">
        <div class="layui-card">
            <div class="layui-card-body">
                <div class="layui-tab layui-tab-brief" lay-filter="component-tabs-brief">
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">
                            <table id="lst" lay-filter="lst"></table>
                            <script type="text/html" id="toolbar">
                                <button class="layui-btn  layui-btn-xs " lay-event="view">查看</button>
                                <button class="layui-btn  layui-btn-xs layui-btn-normal" lay-event="edit">编辑</button>
                                <button class="layui-btn  layui-btn-xs layui-btn-danger" lay-event="del">删除</button>
                            </script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var data_col = [[
            { field: 'id', title: '序号' },
            { field: 'companyName', title: '公司名称' },
            { field: 'credit', title: '信用代码' },
            { field: 'companyType', title: '公司类型' },
            { field: 'legalPerson', title: '法人代表' },
            { field: 'registeredCapital', title: '注册资本' },
            {
                field: 'registeredTime', title: '成立日期', templet: function (d) {
                    return d.registeredTime.FormatDate(false);
                }
            },
            { title: '操作', toolbar: '#toolbar', width: 180 }
        ]];
        layui.use(['table', 'element'], function () {
            var table = layui.table,
                element = layui.element;

            function search() {

            }

            //操作栏的回调函数
            var onTools = function (layEvent, data) {
                var value = data.id;
                //console.log(value);
                if (layEvent === 'view') {
                    window.location.href = '/pages/dpt/companyAdd.html?id=' + value + '&operation=view';
                } else if (layEvent === 'edit') {
                    window.location.href = '/pages/dpt/companyAdd.html?id=' + value;
                } else if (layEvent === "del") {
                    layer_confirm('确定删除吗？', function () {
                        layer_load();
                        Serv.Get('company/delete/' + value, {}, function (result) {
                            if (result.code == "00") {
                                layer_alert(result.message, function () {
                                    lstPager.refresh();
                                });
                            } else {
                                layer_alert(result.message);
                            }
                        });
                    });
                }
            };

            //分页初始化
            var lstPager = Pager(table,//lay-ui的table控件
                "公司列表",//列表名称
                "lst",//绑定的列表Id
                "",//绑定的工具条Id
                data_col,//表头的显示行
                "company/get",//action url 只能post提交
                search, //获取查询条件的函数
                null,//如果在显示之前需要对数据进行整理需要实现，否则传null
                null,//有选择行才能有的操作，实现该方法,否则传null
                onTools, //如果有每行的操作栏的操作回调，实现该方法，否则传null
                null,
                'full-100'
            );
        });
    </script>
</body>
</html>
