<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="../../layui/css/layui.css" />
    <link rel="stylesheet" href="../../lib/ztree/css/metroStyle/metroStyle.css" type="text/css">
    <link rel="stylesheet" href="../../layui/css/common.css" />
    <script type="text/javascript" src="../../lib/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="../../layui/layui.js"></script>
    <script type="text/javascript" src="../../js/pager.js"></script>
    <script type="text/javascript" src="../../js/common.js"></script>
    <script type="text/javascript" src="../../js/service.js"></script>
</head>

<body class="bgf2f2f2">
    <div class="childrenBody">
        <div class="layui-card">
            <div class="layui-card-body">
                <div class="layui-tab layui-tab-brief" lay-filter="component-tabs-brief">
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">
                            <form class="layui-form layui-form2 layui-search-form">
                                <div class="layui-row">
                                    <div class="layui-form-item layui-col-md3 margin-b-20">
                                        <label class="layui-form-label">标题</label>
                                        <div class="layui-input-block">
                                            <input type="text" name="title" placeholder="请输入标题" autocomplete="off"
                                                class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item layui-col-md4 margin-b-20">
                                        <label class="layui-form-label">状态</label>
                                        <div class="layui-input-block">
                                            <select>
                                                <option></option>
                                                <option>未读</option>
                                                <option>已读</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-form-item layui-col-md2 margin-b-20">
                                        <input type="button" class="layui-btn layui-btn-normal" lay-submit
                                            lay-filter="search" value="搜索">
                                    </div>
                                </div>
                            </form>
                            <table id="lst" lay-filter="lst"></table>
                            <script type="text/html" id="toolbar">
									<button class="layui-btn  layui-btn-xs" lay-event="info">查看</button>
								</script>
                            <script type="text/html" id="bar">

								</script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var data_col = [[
            { type: 'id', title: '序号', templet: function (item) { return item.id; } },
            { field: 'title', title: '标题' },
            {
                field: 'createDate', title: '发布日期', templet: function (item) {
                    return item.createDate.FormatDate()
                }
            },
            { field: 'readCount', title: '浏览次数' },
            {
                field: 'isNeedRead', title: '强制阅读', templet: function (item) {
                    if (item == 1)
                        return "是";
                    else
                        return "否";
                }
            },
            { field: 'people', title: '查看人' },
            { title: '操作', toolbar: '#toolbar', width: 180, fixed: 'right' }
        ]];
        var parameter = {
            Title: '',
            IsRead:0
        }

        layui.use(['table', 'element', 'laydate'], function () {
            var table = layui.table,
                element = layui.element,
                form = layui.form,
                laydate = layui.laydate;

            //基本信息
            form.on('submit(search)', function (laydata) {
                parameter.Title = laydata.field.title;
                lstPager.refresh();
            });

            function search() {
                return parameter;
            }

            //分页初始化
            lstPager = Pager2(table,//lay-ui的table控件
                '通知公告列表',//列表名称
                "lst",//绑定的列表Id
                'bar',//绑定的工具条Id
                data_col,//表头的显示行
                "gc/note/GetNotePage",//action url 只能post提交
                search,
                null,//如果在显示之前需要对数据进行整理需要实现，否则传null
                null,//有选择行才能有的操作，实现该方法,否则传null
                null, //如果有每行的操作栏的操作回调，实现该方法，否则传null
                null,
                'full-100'
            );

            table.on('tool(lst)', function (obj) {
                var layEvent = obj.event;
                if (layEvent == "info") {
                    window.location.href = "/pages/note/noteDetail.html?id=" + obj.data.id;
                }
            });
        });
    </script>
</body>

</html>