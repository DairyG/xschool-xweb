<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title></title>
	<link rel="stylesheet" href="../../layui/css/layui.css" />
	<link rel="stylesheet" href="../../layui/css/common.css" />
	<script type="text/javascript" src="../../lib/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="../../layui/layui.js"></script>
	<script type="text/javascript" src="../../js/service.js"></script>
	<script type="text/javascript" src="../../js/verify.js"></script>
	<script type="text/javascript" src="../../js/common.js"></script>
	<script type="text/javascript" src="../../lib/vue.js"></script>
	<script type="text/javascript" src="../../js/pager.js"></script>
</head>

<body class="bgf2f2f2">
	<div class="childrenBody">
		<div class="layui-card-body">
			<table class="layui-table" id="lst" lay-filter="lst"></table>
			<script type="text/html" id="bar">
					<a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="edit">编辑</a>
					<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
				</script>
			<script type="text/html" id="toolbar">
					<button class="layui-btn  layui-btn-sm" lay-event="add"><i class="layui-icon layui-icon-add-1"></i> 添加</button>
				</script>
		</div>
	</div>
	<div class="linePop">
		<div class="layui-card-body padding-r-50">
			<form class="layui-form layui-form2">
				<div class="layui-row">
					<input type="hidden" name="Id" v-model="id" value="0" />
					<div class="layui-form-item layui-col-md12 margin-b-20">
						<label class="layui-form-label">到岗时间<span class="text-red"> *</span></label>
						<div class="layui-input-block">
							<input type="text" name="Name" required lay-verify="name" placeholder="到岗时间"
								autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item layui-col-md12 margin-b-20">
						<label class="layui-form-label">显示顺序</label>
						<div class="layui-input-block">
							<input type="text" name="Sort" required lay-verify="num" placeholder="显示顺序"
								autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item layui-col-md12 margin-b-20">
						<label class="layui-form-label">备注</label>
						<div class="layui-input-block">
							<textarea class="layui-textarea" name="Memo" placeholder="备注"></textarea>
						</div>
					</div>
				</div>
				<div class="layui-row text-right">
					<button class="layui-btn" lay-submit="" lay-filter="formDemo">确认</button>
					<span class="layui-btn layui-btn-primary" onclick="closePop()">返回</span>
				</div>
			</form>
		</div>
	</div>
	<script>
		var layer_linePop;
		var data_col = [[
            { field: 'id', title: '序号' },
            { field: 'name', title: '到岗时间' },
            { field: 'sortId', title: '显示顺序' },
            { field: 'memo', title: '备注' },
            { title: '操作', toolbar: '#bar', width: 180 }
		]];
		//关闭弹窗
		$(".closePop").click(function () {
				layer.closeAll()
			});
		layui.use(['table','element'], function () {
			var table = layui.table,
			    element = layui.element;

			
			// var cols = [[
			// 	{type:'numbers',title:'序号'},
			// 	{field:'title',title:'到岗时间'},
			// 	{field:'sort',title:'显示顺序'},
			// 	{field:'tips',title:'备注'},
			// 	{toolbar:'#bar',title:'操作'}
			// ]];
// 			var datas = [
// 				{'title':'随时','sort':10},
// 				{'title':'一天内','sort':10},
// 				{'title':'三天内','sort':10},
// 				{'title':'一周内','sort':10},
// 			];
// //执行一个 table 实例
// table.render({
// 				elem: '#lst',
// 				title: '用户表',
// 				page: true,
// 				toolbar: '#toolbar',
// 				even: true,
// 				height: 'full-80',
// 				cols: cols,
// 				// data: datas,
// 			});
			//操作栏的回调函数
            var onTools = function (layEvent, data) {
				alert(layEvent);
                var value = data.id;
				//console.log(value);
			 if (layEvent === 'view') {
                    window.location.href = '/pages/dpt/companyAdd.html?id=' + value + '&operation=view';
                } else if (layEvent === 'edit') {
                    window.location.href = '/pages/dpt/companyAdd.html?id=' + value;
                } else if (layEvent === "del") {
                    layer_confirm('确定删除信息吗？', function () {
                        layer_load();
                        // Serv.Get('company/delete/' + value, {}, function (result) {
                        //     if (result.code == "00") {
                        //         layer_alert(result.message, function () {
                        //             lstPager.refresh();
                        //         });
                        //     } else {
                        //         layer_alert(result.message);
                        //     }
                        // });
                    });
                }
            };

            //分页初始化
			var lstPager = Pager(table,//lay-ui的table控件
                "到岗时间",//列表名称
                "lst",//绑定的列表Id
                'toolbar',//绑定的工具条Id
                data_col,//表头的显示行
                "WorkerInField/get",//action url 只能post提交
                null,//如果在显示之前需要对数据进行整理需要实现，否则传null
                null,//有选择行才能有的操作，实现该方法,否则传null
                onTools, //如果有每行的操作栏的操作回调，实现该方法，否则传null
                null,
                'full-100'
			);
			
			table.on('toolbar(lst)', function (data) {
				if (data.event == 'add') {
					layer_linePop = layer.open({
						type: 1,
						title: '添加到岗时间',
						String: false,
						closeBtn: 1,
						skin: 'layui-layer-rim',
						area: '750px',
						content: $('.linePop')
					});
				}
			});
			
		});
		function closePop() {
			layer.close(layer_linePop);
		}

		var model = {
			id: '',
			name: '',
			sort: '0',
			memo: ''
		};
		var vm = new Vue({ el: '#dptForm', data: model });
		function GetSingle(Id) {
			Serv.Post('WorkerInField/GetSingle', { Id: Id }, function (response) {
				model.id = response.id;
				model.name = response.name;
				model.sort = response.sort;
				model.memo = response.memo;
				vm.$set({ data: model });
			})
		}

		layui.use(['table', 'element', 'laydate', 'form'], function () {
			var table = layui.table,
				element = layui.element,
				laydate = layui.laydate,
				layform = layui.form;


			layform.on('submit(formDemo)', function (laydata) {
				layer_load();
				if ($("input[name='Id']").val() == "0") {
					Serv.Post('WorkerInField/add', laydata.field, function (response) {
						layer_confirm('添加成功，是否继续添加？');
						layer_load_lose();
					})
				} else {
					Serv.Post('Department/update', laydata.field, function (response) {
						layer_alert(response.message);
					})
				}
				return false;
			});

		});
	</script>
</body>

</html>